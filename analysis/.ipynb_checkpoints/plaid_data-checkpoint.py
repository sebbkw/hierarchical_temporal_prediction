import numpy as np

def fisher_r_to_z (a, df):
    return 0.5*np.log((1+a)/(1-a)) / (1/df)**0.5

# Movshon & Newshome (1996)
PI_dist_MT_raw = """-0.33271275602405326, 0.9846755418477927
-0.26688559255077404, 0.8385427308091684
-0.2422004062482943, 0.16870467717849336
-0.2604988177427652, 0.38597250415817874
-0.15683080361888524, 0.2134937290792105
-0.15279034734133434, 0.4084996468564327
-0.1362598150334855, -0.12813017323383669
-0.09717493672122601, 0.8683501125130906
-0.08806302307340941, 0.7537097615410467
-0.08380299236124711, 0.21906569628175698
-0.1069806328164733, 0.38345246193820615
-0.0660349802574065, 0.16727725310425856
-0.03172988798004983, 0.9514130018953945
-0.02577406963681894, 0.5739401503386461
-0.026205026101596696, -0.24406166774701288
0.023508139978941633, 0.7587873752645486
-0.005634037516196955, -0.1387249947131135
-0.02865409012572062, 0.42292968058490554
0.01639645696325065, 0.9264029041875158
0.018669034054179523, 0.606976031370455
0.04203179966188353, 0.7264038129858337
0.07712135707929613, 0.7117630450652002
0.06019312595708226, -0.3018359620260691
0.10162404917664736, -0.15854861889775695
0.07564052101678831, 0.8050112508875464
0.1414839341746903, 0.6651078451117587
0.12602028943036148, 0.22139700037397025
0.13194583031940033, 0.5359305115283385
0.14516107716131832, 0.6440488307490388
0.15381808642511396, -0.12821925120583555
0.1612918559936769, 0.8163887289213793
0.19541309092511017, -0.18792614160083043
0.1949331011914508, 0.49616177041558795
0.21418651221186935, 0.8811382824697642
0.23401797950371028, 0.12393236444760736
0.23669642648797162, 0.3540090563004348
0.2432707253041504, 0.7120550802366189
0.24576297969045813, 0.6186324166734379
0.2657657624379164, 0.3610595210160956
0.26483332040463914, -0.094838030777183
0.2710354580468084, -0.2625112382269137
0.27554925401435915, -0.032026768648586446
0.29762140761873535, 0.04395315781766129
0.28365267207373335, -0.32495990759430504
0.2862336224572364, 0.7595374477996212
0.31733048327457936, 0.8858464687471919
0.31527338441603936, -0.19664767284195261
0.34646912580002254, 0.379190783116225
0.32761597756727934, 0.32096469109348824
0.33603029993338596, -0.02957506138623467
0.35117620788318304, 0.22469392399726074
0.3492643573146237, 0.783892879445823
0.35824850323213786, 0.47723961139098936
0.3827266902830808, -0.10023175138454632
0.37655207865773144, 0.1677431267460887
0.4372290361227711, 0.3622978674007724
0.3889504198952485, -0.019621789763323072
0.44499513141451974, 0.6073611804651807
0.384068401410089, 0.7265186331998006
0.42738527220646816, 0.0453108973582641
0.43822923135288994, 0.4489232385590839
0.4518073412130883, 0.27834616209478513
0.44997722315276834, 0.12841429939854743
0.4648661008356889, 0.38799991311677884
0.48137454043281447, 0.32680575665325295
0.4315384612227422, -0.11483098534088043
0.446927711362598, -0.25567100759317984
0.43091204311155784, -0.3228792809837573
0.4614527301713236, 0.8978478345883889
0.4414516912168194, -0.05083845560939104
0.47469854595288763, 0.5956850986639215
0.523863208671993, 0.30276689245693666
0.501190876364336, 0.851752343946869
0.542537963829387, 0.6790244561350673
0.4899304627802048, 0.18411076837860396
0.4971722726267156, 0.07013294164411432
0.5189261714114972, -0.360933659740553
0.5245998994860548, 0.3934560891720461
0.5510097309969748, -0.23439293552632368
0.5560590437575046, -0.023967363868525826
0.5724107417335365, 0.642375187649435
0.5601658320476459, 0.29156937935057636
0.567039428047349, 0.23775720308813253
0.5893680926013232, 0.42979827130477477
0.5997327431464357, 0.12331058061367717
0.6135527189043362, -0.186091912882272
0.6094385211872562, 0.8848924497051487
0.6345267100216636, -0.03943872543428584
0.6584540729695487, 0.5692888731969927
0.6365969771522295, -0.10704323013700057
0.610560529018495, 0.30901321722390795
0.6260004049478638, 0.48840199975784504
0.6172014836394555, 0.10860097813517933
0.6670372892263756, 0.38979914773557156
0.6547899853379031, -0.16718064172720326
0.7133595929472543, -0.017691214447376424
0.6864484793648578, 0.7428020267938114
0.6957806839426242, 0.556275860799139
0.6737175248651612, 0.27516926367590344
0.7049460155201788, -0.3874037805907078
0.7165074622758094, -0.04831777260101311
0.7393945416575189, 0.09238514040148393
0.7076787822894117, 0.7716872433015435
0.7498330120109704, 0.32947861077551854
0.7513783424265144, 0.6327275922787245
0.7558881091263052, 0.20687539666693466
0.7728478099445424, -0.04665989105846702
0.7504572448091296, -0.3433267716075332
0.7642696868095717, 0.5116492329588576
0.7698922321533741, 0.9711297095234014
0.7863490230216941, -0.12582385695486487
0.8164899932533449, 0.07558134601310051
0.7972809520115607, 0.8045243275081937
0.8079974027690386, -0.3969906361578126
0.8357193956266535, 0.20424490649427984
0.8503345658688224, 0.4798143607275225
0.8470334393486236, 0.5929221348962435
0.8899683322244758, 0.3044850846332703
0.828832711319502, 0.11953056303592868
0.8906146301100664, 0.8119005237347472
0.8845214803067256, 0.6868864611867291
0.9010959017681943, 0.03731507827531755
0.9119299283941891, 0.2387828320173384
0.9323542002453584, 0.024303955856034287
0.9258141634486108, 0.3282632544872969
0.9648856672498944, -0.06248902054274397
0.9569704335134726, 0.2760825641714616
-0.012891344383057168, 0.12795391571639714
-0.012891344383057168, 0.04020254460122352
0.24493554327808442, 0.3953356833355216
0.27071823204419876, 0.41000804656909773
0.2633517495395945, 0.4429013436760363
0.31123388581952094, 0.4173947296655791
0.3738489871086552, 0.5271984135801845
0.4143646408839776, 0.4980220253786768
0.39963167587476955, 0.5784338481117495
0.42541436464088367, 0.5565431400473367
0.1344383057090237, 0.7095760905794538
-0.038674033149171505, 0.7311974574188356
-0.009208103130755374, 0.760501782702233
0.0055248618784529135, 0.7970917881227251
0.22283609576427232, 0.91814720171301
0.4953959484346222, 0.8820824116813288
0.5174953959484343, 0.896748041384279
0.4990791896869242, 0.7833688527073842
0.2412523020257824, 0.7609596627847861
0.2633517495395945, 0.6513108500745737
0.5101289134438303, 0.7212318320926802
0.5395948434622464, 0.7139730860780886
0.6169429097605887, 0.6080815834570619
0.7127071823204416, 0.6265381909023267
0.9005524861878447, 0.795071728934991
0.863720073664825, 0.498843516115022
0.5359116022099446, 0.4507122392019419
0.5690607734806625, 0.4727106837563674
0.5911602209944748, 0.46543847068052413
0.7642725598526698, 0.37069096124516443
0.8618784530386738, 0.33979078920345684
0.7642725598526698, 0.25003282596180065
0.5616942909760585, 0.35935169567134984
0.5322283609576424, 0.34101629177734905
0.7421731123388577, 0.067177068288101
0.7790055248618784, 0.1147763962817443
0.8968692449355429, -0.027604108800387772
0.9594843462246769, -0.034802253039347475
0.7274401473296497, 0.008649220088815301
0.6464088397790049, 0.019470003804444413
0.6721915285451192, -0.12490699310823139
0.5285451197053408, -0.2037802040933132
0.7900552486187842, 0.09285875409482847
0.5543278084714547, 0.09608411526457727
0.6058931860036829, 0.19489867719790854
0.5801104972375686, 0.012036185993583137
0.6611418047882134, 0.03046585931634449
0.31491712707182296, 0.06273967160571137
0.48434622467771593, 0.300709377451426
0.5543278084714547, 0.40687022129748385
0.28913443830570884, -0.28831294756936376
0.46224677716390383, 0.31163789765706806
0.8121546961325963, 0.1075243837977784
0.43646408839778994, 0.2677150773851008
0.6832412523020255, 0.5752960228401357"""

# Hu et al. (2018)
PI_dist_V2_raw = """2.596577017114914, 7.267762117071768
0.2982885085574569, 4.315319526343544
3.1100244498777503, 6.142828035859821
1.4963325183374092, 3.6839373891365845
1.4718826405867977, 3.144601850520159
7.02200488997555, 7.6325926458603
5.8239608801955995, 6.597308116400595
6.63080684596577, 6.037537753487703
6.459657701711491, 5.693561532192339
5.628361858190708, 4.709094395704492
4.259168704156478, 3.3543434488709902
3.6968215158924203, 3.694724099908912
3.354523227383863, 3.7910853828083795
3.2078239608801944, 2.0991897981686556
2.449877750611247, 3.369984179490867
2.6699266503667474, 2.684788340764179
2.0342298288508562, 2.55912316026655
1.7897310513447433, 2.6804736564552485
1.2273838630806848, 2.3345797976892477
1.1784841075794619, 2.1872812694760064
1.4718826405867977, 1.894601850520159
2.0097799511002457, 1.5786111510618905
1.6919315403422974, -0.310201831343786
1.814180929095354, 0.03353468526774961
2.1809290953545233, 0.28043050961215776
2.645476772616137, 0.5768253511673613
3.6968215158924203, -0.006256292247950768
4.185819070904644, -0.2244474807037733
2.9388753056234727, 1.5341459322115139
3.4278728606356967, 1.6345821947360832
3.599022004889976, 1.5864015532863505
3.843520782396089, 0.8523059590584392
4.308068459657703, 0.21732825159403468
5.188264058679707, -0.31757275037154287
5.45721271393643, -0.022136727551657742
6.2151589242053795, 0.07961791073397428
6.141809290953544, -0.4109377247231407
6.484107579462103, -0.16416175272064848
6.973105134474327, -0.11274509803921617
8.464547677261614, 1.1935855026607207
7.21760391198044, 1.530610288125029
4.039119804400977, 2.1277745817153253
4.3569682151589255, 2.031293446473944
4.821515892420539, 1.2982765233232652
5.06601466992665, 1.274965242820846
5.090464547677261, 1.07900666379021
4.84596577017115, 1.0778081403710633
5.84841075794621, 1.2052711059974097
5.946210268948656, 1.5979073781101665
5.946210268948656, 1.9410446330121278
6.141809290953544, 2.26063090272784
5.8728606356968225, 2.7249988014765805
5.750611246943766, 2.6998897358454386
5.188264058679707, 2.868701759432378
4.8948655256723725, 3.357459609760774
4.67481662591687, 3.4299103504482478
5.677261613691931, 4.292667433721655
6.63080684596577, 4.248322067213193
4.943765281173594, 1.1763267654249958"""

# Movshon & Newshome (1996)
PI_dist_V1_raw = """0.26313716789616737, 0.6136351527328682
0.3505075156691997, -0.40011149555331715
0.40809251761051635, 0.329705594150454
0.45972045038549036, -0.12784989832844884
0.5312052803816074, 0.03690249185633343
0.5748904542681237, -0.232193170377073
0.6205613178767544, 0.47143205528174903
0.6349726114660388, 0.3328091919649073
0.6741749403738424, 0.004816417898273917
0.6837262188695987, 0.3611792464142657
0.7019745964834436, 0.7855663271651081
0.7049531310666148, 0.9465181943583796
0.7323272822357645, 0.12787407086012448
0.7536025292584172, -0.31190742637911373
0.7655166675911034, 0.1912627132479252
0.7804093405069612, 0.5309994031865788
0.8101508111575224, 0.12030034686569702
0.8131556340800519, -0.01705339702213937
0.8229775639247878, -0.09674347208062484
0.8366085905524276, 0.07045071735993136
0.883420665398557, 0.03549394404973216
0.8687690363592944, -0.13255490672747783
0.8846580509179656, 0.32511813443101967
0.9084863275833379, 0.2371597773181653
0.9023264986657293, 0.11825344523981074
0.9194076210549673, 0.6440510077148178
0.9398051930826419, 0.019373819040554574
0.9029369349381537, -0.09733600080729277
0.940257363137168, -0.24210089474238172
0.9561428809140831, -0.16401117102427176
0.9689635297720824, 0.17101476420713657
0.9839425370236843, 0.06540711953652179
0.8758389261744968, 0.10511168819488925
0.8590604026845645, -0.11605004890222914
0.84228187919463, -0.008903578294155112
0.8506711409395973, 0.026300405832293317
0.9597315436241611, 0.05849156296021496
0.9328859060402686, 0.0014502040403359118"""


x_V1 = [float(l.split(', ')[0]) for l in PI_dist_V1_raw.split('\n')]
y_V1 = [float(l.split(', ')[1]) for l in PI_dist_V1_raw.split('\n')]
PI_dist_V1 = [fisher_r_to_z(y, 16-3)-fisher_r_to_z(x, 16-3) for (x,y) in zip(x_V1, y_V1)]

x_V2 = [float(l.split(', ')[0]) for l in PI_dist_V2_raw.split('\n')]
y_V2 = [float(l.split(', ')[1]) for l in PI_dist_V2_raw.split('\n')]
PI_dist_V2 = [y-x for (x, y) in zip(x_V2, y_V2)]

x_MT = [float(l.split(', ')[0]) for l in PI_dist_MT_raw.split('\n')]
y_MT = [float(l.split(', ')[1]) for l in PI_dist_MT_raw.split('\n')]
PI_dist_MT = [fisher_r_to_z(y, 16-3)-fisher_r_to_z(x, 16-3) for (x,y) in zip(x_MT, y_MT)]

plaid_data = {
    'PI_dist_V1': PI_dist_V1,
    'PI_dist_V2': PI_dist_V2,
    'PI_dist_MT': PI_dist_MT
}